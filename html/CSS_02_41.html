<!DOCTYPE html>
<html lang="ko">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- 기본 CSS (모든 디바이스) -->
 <link rel="stylesheet" href="base.css">

 <!-- 조건부 CSS 로딩 -->
 <link rel="stylesheet" href="mobile.css" media="(max-width: 767px)">
 <link rel="stylesheet" href="tablet.css" media="(min-width: 768px) and (max-width: 1023px)">
 <link rel="stylesheet" href="desktop.css" media="(min-width: 1024px)">

 <!-- 고해상도 디스플레이용 CSS -->
 <link rel="stylesheet" href="retina.css" media="(-webkit-min-device-pixel-ratio: 2)">
 <title>반응형 이미지 최적화</title>
 <style>
 .hero-image {
 width: 100%;
 height: auto;
 display: block;
 margin: 0 auto;
 }

 .container {
 max-width: 1200px;
 margin: 0 auto;
 padding: 20px;
 }
   <style>
 .lazy-image {
 width: 100%;
 height: 300px;
 background-color: #f0f0f0;
 margin-bottom: 20px;
 opacity: 0;
 transition: opacity 0.3s ease;
 }

 .lazy-image.loaded {
 opacity: 1;
 }

 .placeholder {
 display: flex;
 align-items: center;
 justify-content: center;
 color: #666;
 font-size: 14px;
 }
</style>

<div class="container">
 <h2>지연 로딩 이미지들</h2>

 <!-- 지연 로딩될 이미지들 -->
 <img class="lazy-image placeholder"
 data-src="image1.jpg"
 alt="이미지 1">

 <img class="lazy-image placeholder"
 data-src="image2.jpg"
 alt="이미지 2">

 <img class="lazy-image placeholder"
 data-src="image3.jpg"
 alt="이미지 3">
</div>

<script>
// Intersection Observer를 사용한 지연 로딩
const lazyImages = document.querySelectorAll('.lazy-image');

const imageObserver = new IntersectionObserver((entries, observer) => {
 entries.forEach(entry => {
 if (entry.isIntersecting) {
 const img = entry.target;
 const src = img.getAttribute('data-src');

 // 실제 이미지 로드
 img.src = src;
 img.classList.add('loaded');
 img.classList.remove('placeholder');

 // 관찰 중단
 observer.unobserve(img);
 }
 });
});

// 모든 지연 로딩 이미지 관찰 시작
lazyImages.forEach(img => imageObserver.observe(img));
  // 디바이스 감지 및 조건부 기능 로딩
class PerformanceOptimizer {
 constructor() {
 this.isMobile = window.innerWidth <= 768;
 this.isRetina = window.devicePixelRatio > 1;
 this.connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
 }

 // 네트워크 상태 확인
 isSlowConnection() {
 if (!this.connection) return false;
 return this.connection.effectiveType === 'slow-2g' ||
 this.connection.effectiveType === '2g';
 }

 // 조건부 리소스 로딩
 loadConditionalResources() {
 // 느린 연결에서는 고해상도 이미지 제외
 if (this.isSlowConnection()) {
 this.disableHighResImages();
 }

 // 모바일에서는 데스크톱 전용 기능 제외
 if (this.isMobile) {
 this.loadMobileOptimizedFeatures();
 } else {
 this.loadDesktopFeatures();
 }
 }

 disableHighResImages() {
 const images = document.querySelectorAll('img[srcset]');
 images.forEach(img => {
 // srcset 제거하고 기본 src만 사용
 const basicSrc = img.src;
 img.removeAttribute('srcset');
 img.src = basicSrc;
 });
 }

 loadMobileOptimizedFeatures() {
 // 모바일에 필요한 기능만 로드
 import('./mobile-features.js').then(module => {
 module.initMobileFeatures();
 });
 }

 loadDesktopFeatures() {
 // 데스크톱 전용 기능 로드
 import('./desktop-features.js').then(module => {
 module.initDesktopFeatures();
 });
 }
}

// 페이지 로드 시 최적화 실행
document.addEventListener('DOMContentLoaded', () => {
 const optimizer = new PerformanceOptimizer();
 optimizer.loadConditionalResources();
});

</script>

 </style>
</head>
<body>
 <div class="container">
 <h1>반응형 이미지 예제</h1>

 <!-- 기본 반응형 이미지 -->
 <img src="hero-mobile.jpg"
 srcset="hero-mobile.jpg 480w,
 hero-tablet.jpg 768w,
 hero-desktop.jpg 1200w"
 sizes="(max-width: 480px) 100vw,
 (max-width: 768px) 100vw,
 1200px"
 alt="메인 히어로 이미지"
 class="hero-image">
 </div>
</body>
</html>
